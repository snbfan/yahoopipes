"use strict";angular.module("yahoopipes",["ngRoute"]).config(["$routeProvider",function(e){e.when("/",{templateUrl:"partials/main.html",controller:"pipeController"}).when("/:pipeId",{templateUrl:"partials/pipe.html",controller:"pipeItemController"}).otherwise({redirectTo:"/"})}]).service("localCacheService",["$q",function(e){function n(e){o=e}function r(){return o}function i(n){var r=e.defer(),i="We wasn't able to find an item.";return o&&o.length>0&&void 0!=o[n]?r.resolve(o[n]):r.reject(i),r.promise}var o=!1;return{setCollection:n,getCollection:r,getById:i}}]).service("pipeService",["$q","$http",function(e,n){function r(r){var i="http://pipes.yahoo.com/pipes/pipe.run?_id="+r+"&_render=json&_callback=JSON_CALLBACK",o=e.defer();return n.jsonp(i).success(function(e){o.resolve(e.value.items)}).error(function(e,n){o.reject(n)}),o.promise}return{fetch:r}}]).controller("pipeController",["$scope","$http","$q","pipeService","localCacheService",function(e,n,r,i,o){e.pipes=[],e.error="",e.loading=!1,e.pipeId="74fc14a798efee89310bea2b56f99336",e.showSpinner=function(){e.loading=!0},e.hideSpinner=function(){e.loading=!1},e.showError=function(n){e.error=n||"Sorry, we couldn't get any pipes."},e.getPipes=function(){e.pipes||(e.showSpinner(),i.fetch(e.pipeId).then(function(n){o.setCollection(n),e.pipes=n,e.hideSpinner()},function(n){e.showError(n),e.hideSpinner()}))},function(){e.pipes=o.getCollection()}()}]).controller("pipeItemController",["$scope","$routeParams","localCacheService",function(e,n,r){e.pipe=null,e.error="",e.loading=!1,e.pipeId=null,e.showSpinner=function(){e.loading=!0},e.hideSpinner=function(){e.loading=!1},e.showError=function(n){e.error=n||"Sorry, we couldn't get any pipes."},e.getPipeObject=function(){e.pipeId=parseInt(n.pipeId)-1,r.getById(e.pipeId).then(function(n){e.pipe=n,e.hideSpinner()},function(n){e.showError(n),e.hideSpinner()})},e.getPipeObject()}]);